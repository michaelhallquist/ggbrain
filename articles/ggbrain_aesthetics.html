<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Aesthetic refinements of ggbrain plots • ggbrain</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aesthetic refinements of ggbrain plots">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggbrain</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/ggbrain_aesthetics.html">Aesthetic refinements of ggbrain plots</a></li>
    <li><a class="dropdown-item" href="../articles/ggbrain_introduction.html">Introduction to ggbrain</a></li>
    <li><a class="dropdown-item" href="../articles/ggbrain_labels.html">Working with annotations and labels in ggbrain</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/michaelhallquist/ggbrain/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Aesthetic refinements of ggbrain plots</h1>
                        <h4 data-toc-skip class="author">Michael
Hallquist</h4>
            
            <h4 data-toc-skip class="date">2025-12-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/michaelhallquist/ggbrain/blob/main/vignettes/ggbrain_aesthetics.Rmd" class="external-link"><code>vignettes/ggbrain_aesthetics.Rmd</code></a></small>
      <div class="d-none name"><code>ggbrain_aesthetics.Rmd</code></div>
    </div>

    
    
<p>This vignette covers the advanced aesthetic refinement capabilities
of <code>ggbrain</code>, allowing you to create publication-quality
brain visualizations. We’ll cover image cleaning operations, custom
color scales, combining multiple layers, adding region labels, and
combining plots using <code>patchwork</code>.</p>
<div class="section level2">
<h2 id="images-used-in-this-demo">Images used in this demo<a class="anchor" aria-label="anchor" href="#images-used-in-this-demo"></a>
</h2>
<p>The package includes several images for demonstration purposes:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MNI 2009c anatomical underlay</span></span>
<span><span class="va">underlay_2mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"mni_template_2009c_2mm.nii.gz"</span>, package <span class="op">=</span> <span class="st">"ggbrain"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parametric modulator: entropy change following feedback in learning task</span></span>
<span><span class="va">echange_overlay_2mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"echange_ptfce_fwep_0.05_2mm.nii.gz"</span>, package <span class="op">=</span> <span class="st">"ggbrain"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Signed reward prediction error following feedback </span></span>
<span><span class="va">pe_overlay_2mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pe_ptfce_fwep_0.05_2mm.nii.gz"</span>, package <span class="op">=</span> <span class="st">"ggbrain"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Absolute reward prediction error</span></span>
<span><span class="va">abspe_overlay_2mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"abspe_ptfce_fwep_0.05_2mm.nii.gz"</span>, package <span class="op">=</span> <span class="st">"ggbrain"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Schaefer 200-parcel atlas of cortex</span></span>
<span><span class="va">schaefer200_atlas_2mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Schaefer_200_7networks_2009c_2mm.nii.gz"</span>, package <span class="op">=</span> <span class="st">"ggbrain"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Labels for the Schaefer atlas</span></span>
<span><span class="va">schaefer_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Schaefer_200_7networks_labels.csv"</span>, package <span class="op">=</span> <span class="st">"ggbrain"</span><span class="op">)</span>, </span>
<span>  na.strings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"NA"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>value <span class="op">=</span> <span class="va">roi_num</span><span class="op">)</span> <span class="co"># ggbrain requires a 'value' column for merging</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adjustments-to-the-appearance-of-image-layers">Adjustments to the appearance of image layers<a class="anchor" aria-label="anchor" href="#adjustments-to-the-appearance-of-image-layers"></a>
</h2>
<p>When rendering brain slices, particularly functional activation maps,
the raw data often contains visual artifacts that can be distracting or
aesthetically unappealing. <code>ggbrain</code> provides several tools
for cleaning up the appearance of image layers.</p>
<div class="section level3">
<h3 id="removing-small-specks-remove_specks">Removing small specks (<code>remove_specks</code>)<a class="anchor" aria-label="anchor" href="#removing-small-specks-remove_specks"></a>
</h3>
<p>At times, when slicing a given image (especially functional
activations), it is possible that some clusters are very small, yielding
small ‘specks’ on some rendered slices. These are visually unappealing
and may merit removal. The <code>remove_specks</code> argument specifies
the pixel threshold used to remove clusters smaller than a certain size.
For example, <code>remove_specks = 20</code> would remove any clusters
smaller than 20 pixels in size from each slice on the rendered
image.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">base_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray80"</span>, text_color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span>, overlay <span class="op">=</span> <span class="va">pe_overlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"z = 4"</span>, <span class="st">"z = 20"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"underlay"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Without removing specks</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">base_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"overlay"</span>, fill_scale <span class="op">=</span> <span class="fu">scale_fill_distiller</span><span class="op">(</span><span class="st">"z"</span>, palette <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Without remove_specks"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With remove_specks = 20</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">base_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"overlay"</span>, fill_scale <span class="op">=</span> <span class="fu">scale_fill_distiller</span><span class="op">(</span><span class="st">"z"</span>, palette <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span>, </span>
<span>             remove_specks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"With remove_specks = 20"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/remove_specks_comparison-1.png" class="r-plt" width="768"></p>
<p>Note that removing specks can, at the extreme, misrepresent the data,
so use this feature judiciously.</p>
</div>
<div class="section level3">
<h3 id="filling-small-holes-fill_holes">Filling small holes (<code>fill_holes</code>)<a class="anchor" aria-label="anchor" href="#filling-small-holes-fill_holes"></a>
</h3>
<p>Another common aesthetic issue is small holes inside clusters. These
may reflect voxels that fall slightly below a statistical threshold. The
<code>fill_holes</code> argument specifies the size of holes (in pixels)
that should be filled on the rendered slices using nearest neighbor
imputation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Without filling holes</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">base_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"overlay"</span>, fill_scale <span class="op">=</span> <span class="fu">scale_fill_distiller</span><span class="op">(</span><span class="st">"z"</span>, palette <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Without fill_holes"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With fill_holes = 100</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">base_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"overlay"</span>, fill_scale <span class="op">=</span> <span class="fu">scale_fill_distiller</span><span class="op">(</span><span class="st">"z"</span>, palette <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span>, </span>
<span>             fill_holes <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"With fill_holes = 100"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/fill_holes_comparison-1.png" class="r-plt" width="768"></p>
<p>For integer-valued or categorical images, the mode of the neighboring
voxels is used for imputation rather than the mean.</p>
</div>
<div class="section level3">
<h3 id="trimming-threads-trim_threads">Trimming threads (<code>trim_threads</code>)<a class="anchor" aria-label="anchor" href="#trimming-threads-trim_threads"></a>
</h3>
<p>The <code>trim_threads</code> argument iteratively removes pixels
that have fewer than the specified number of neighboring pixels
(including diagonals). This helps clean up thin “threads” or isolated
pixels that can occur at the edges of clusters.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Without trimming</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">base_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"overlay"</span>, fill_scale <span class="op">=</span> <span class="fu">scale_fill_distiller</span><span class="op">(</span><span class="st">"z"</span>, palette <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Without trim_threads"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With trim_threads = TRUE (uses default of 3 neighbors)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">base_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"overlay"</span>, fill_scale <span class="op">=</span> <span class="fu">scale_fill_distiller</span><span class="op">(</span><span class="st">"z"</span>, palette <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span>, </span>
<span>             trim_threads <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"With trim_threads = TRUE"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/trim_threads_comparison-1.png" class="r-plt" width="768"></p>
</div>
<div class="section level3">
<h3 id="combining-image-cleaning-operations">Combining image cleaning operations<a class="anchor" aria-label="anchor" href="#combining-image-cleaning-operations"></a>
</h3>
<p>For the best visual results, you can combine all three cleaning
operations:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_clean</span> <span class="op">&lt;-</span> <span class="va">base_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"overlay"</span>, </span>
<span>    fill_scale <span class="op">=</span> <span class="fu">scale_fill_distiller</span><span class="op">(</span><span class="st">"z-stat"</span>, palette <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span>,</span>
<span>    remove_specks <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    fill_holes <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    trim_threads <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gg_clean</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/combined_cleaning-1.png" class="r-plt" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="working-with-color-scales">Working with color scales<a class="anchor" aria-label="anchor" href="#working-with-color-scales"></a>
</h2>
<div class="section level3">
<h3 id="custom-color-scales">Custom color scales<a class="anchor" aria-label="anchor" href="#custom-color-scales"></a>
</h3>
<p>You can use any ggplot2 <code>scale_fill_*</code> function to
customize the color mapping:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_viridis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray80"</span>, text_color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span>, overlay <span class="op">=</span> <span class="va">echange_overlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x = 0"</span>, <span class="st">"y = 0"</span>, <span class="st">"z = 30"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"underlay"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"overlay"</span>, </span>
<span>    fill_scale <span class="op">=</span> <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="st">"Entropy\nChange"</span>, option <span class="op">=</span> <span class="st">"magma"</span><span class="op">)</span>,</span>
<span>    remove_specks <span class="op">=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gg_viridis</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/custom_scales-1.png" class="r-plt" width="768"></p>
</div>
<div class="section level3">
<h3 id="bisided-color-scales">Bisided color scales<a class="anchor" aria-label="anchor" href="#bisided-color-scales"></a>
</h3>
<p>For maps with both positive and negative values (e.g., signed
prediction errors), use <code><a href="../reference/scale_fill_bisided.html">scale_fill_bisided()</a></code> to create
separate color scales:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_bisided</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray80"</span>, text_color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span>, overlay <span class="op">=</span> <span class="va">pe_overlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x = 0"</span>, <span class="st">"y = 0"</span>, <span class="st">"z = 30"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"underlay"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"overlay"</span>,</span>
<span>    fill_scale <span class="op">=</span> <span class="fu"><a href="../reference/scale_fill_bisided.html">scale_fill_bisided</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="st">"Signed PE"</span>,</span>
<span>      neg_scale <span class="op">=</span> <span class="fu">scale_fill_distiller</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Blues"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>      pos_scale <span class="op">=</span> <span class="fu">scale_fill_distiller</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span>,</span>
<span>      symmetric <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    remove_specks <span class="op">=</span> <span class="fl">20</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gg_bisided</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/bisided_scale-1.png" class="r-plt" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="working-with-categorical-images-and-labels">Working with categorical images and labels<a class="anchor" aria-label="anchor" href="#working-with-categorical-images-and-labels"></a>
</h2>
<div class="section level3">
<h3 id="mapping-fills-to-label-columns">Mapping fills to label columns<a class="anchor" aria-label="anchor" href="#mapping-fills-to-label-columns"></a>
</h3>
<p>When working with labeled images (e.g., atlases), you can map the
fill color to label columns rather than numeric values. This requires
adding labels to your image and specifying the appropriate aesthetic
mapping:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a subset of labels for Dorsal Attention Network</span></span>
<span><span class="va">dan_labels</span> <span class="op">&lt;-</span> <span class="va">schaefer_labels</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">network</span> <span class="op">==</span> <span class="st">"DorsAttn"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    dan_group <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>      <span class="va">value</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">31</span>, <span class="fl">32</span>, <span class="fl">135</span>, <span class="fl">136</span><span class="op">)</span> <span class="op">~</span> <span class="st">"MT+"</span>,</span>
<span>      <span class="va">value</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">33</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">137</span><span class="op">:</span><span class="fl">144</span><span class="op">)</span> <span class="op">~</span> <span class="st">"PPC"</span>,</span>
<span>      <span class="va">value</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">41</span><span class="op">:</span><span class="fl">43</span>, <span class="fl">145</span><span class="op">:</span><span class="fl">147</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Premotor"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    dan_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">dan_group</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MT+"</span>, <span class="st">"PPC"</span>, <span class="st">"Premotor"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Define colors for DAN groups</span></span>
<span><span class="va">dan_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MT+"</span> <span class="op">=</span> <span class="st">"#E41A1C"</span>, <span class="st">"PPC"</span> <span class="op">=</span> <span class="st">"#377EB8"</span>, <span class="st">"Premotor"</span> <span class="op">=</span> <span class="st">"#4DAF4A"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_dan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray90"</span>, text_color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>dan_atlas <span class="op">=</span> <span class="va">schaefer200_atlas_2mm</span><span class="op">)</span>, labels <span class="op">=</span> <span class="va">dan_labels</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x = -30"</span>, <span class="st">"z = 50"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"underlay"</span>, </span>
<span>    fill_scale <span class="op">=</span> <span class="fu">scale_fill_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"grey30"</span>, high <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span>, </span>
<span>    show_legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"dan_atlas"</span>, </span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">dan_group</span><span class="op">)</span>,</span>
<span>    fill_scale <span class="op">=</span> <span class="fu">scale_fill_manual</span><span class="op">(</span><span class="st">"DAN Region"</span>, values <span class="op">=</span> <span class="va">dan_colors</span><span class="op">)</span>,</span>
<span>    show_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    remove_specks <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    fill_holes <span class="op">=</span> <span class="fl">20</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gg_dan</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/categorical_labels-1.png" class="r-plt" width="768"></p>
</div>
<div class="section level3">
<h3 id="combining-fills-with-outlines">Combining fills with outlines<a class="anchor" aria-label="anchor" href="#combining-fills-with-outlines"></a>
</h3>
<p>A powerful technique is to combine filled regions with outlines to
highlight different groupings. For example, you might fill regions by
network and outline individual parcels:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_outlined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray90"</span>, text_color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>dan_atlas <span class="op">=</span> <span class="va">schaefer200_atlas_2mm</span><span class="op">)</span>, labels <span class="op">=</span> <span class="va">dan_labels</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x = -30"</span>, <span class="st">"z = 50"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"underlay"</span>, </span>
<span>    fill_scale <span class="op">=</span> <span class="fu">scale_fill_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"grey30"</span>, high <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span>, </span>
<span>    show_legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"dan_atlas"</span>, </span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">dan_group</span><span class="op">)</span>,</span>
<span>    fill_scale <span class="op">=</span> <span class="fu">scale_fill_manual</span><span class="op">(</span><span class="st">"DAN Region"</span>, values <span class="op">=</span> <span class="va">dan_colors</span><span class="op">)</span>,</span>
<span>    show_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    remove_specks <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    fill_holes <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    unify_scales <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add outlines for individual Schaefer regions</span></span>
<span>  <span class="fu"><a href="../reference/geom_outline.html">geom_outline</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"dan_atlas"</span>, </span>
<span>    size <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>group <span class="op">=</span> <span class="va">MNI_Glasser_HCP_v1.0</span><span class="op">)</span>,</span>
<span>    outline <span class="op">=</span> <span class="st">"cyan"</span>,</span>
<span>    remove_specks <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gg_outlined</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/fills_with_outlines-1.png" class="r-plt" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="adding-region-labels">Adding region labels<a class="anchor" aria-label="anchor" href="#adding-region-labels"></a>
</h2>
<div class="section level3">
<h3 id="using-geom_region_label_repel">Using geom_region_label_repel<a class="anchor" aria-label="anchor" href="#using-geom_region_label_repel"></a>
</h3>
<p>The <code><a href="../reference/geom_region_label_repel.html">geom_region_label_repel()</a></code> function adds text labels
to regions, using <code>ggrepel</code> to prevent overlapping. This is
extremely useful for labeling multiple regions:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add custom short labels for display</span></span>
<span><span class="va">dan_labels_short</span> <span class="op">&lt;-</span> <span class="va">dan_labels</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    short_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Anterior"</span>, <span class="st">"Ant."</span>, <span class="va">MNI_Glasser_HCP_v1.0</span><span class="op">)</span>,</span>
<span>    short_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Posterior"</span>, <span class="st">"Post."</span>, <span class="va">short_label</span><span class="op">)</span>,</span>
<span>    short_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Superior"</span>, <span class="st">"Sup."</span>, <span class="va">short_label</span><span class="op">)</span>,</span>
<span>    short_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Inferior"</span>, <span class="st">"Inf."</span>, <span class="va">short_label</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">gg_labeled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray90"</span>, text_color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>dan_atlas <span class="op">=</span> <span class="va">schaefer200_atlas_2mm</span><span class="op">)</span>, labels <span class="op">=</span> <span class="va">dan_labels_short</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x = -30"</span>, <span class="st">"z = 50"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"underlay"</span>, </span>
<span>    fill_scale <span class="op">=</span> <span class="fu">scale_fill_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"grey30"</span>, high <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span>, </span>
<span>    show_legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"dan_atlas"</span>, </span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">dan_group</span><span class="op">)</span>,</span>
<span>    fill_scale <span class="op">=</span> <span class="fu">scale_fill_manual</span><span class="op">(</span><span class="st">"DAN Region"</span>, values <span class="op">=</span> <span class="va">dan_colors</span><span class="op">)</span>,</span>
<span>    show_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    remove_specks <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    fill_holes <span class="op">=</span> <span class="fl">20</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_region_label_repel.html">geom_region_label_repel</a></span><span class="op">(</span></span>
<span>    image <span class="op">=</span> <span class="st">"dan_atlas"</span>, </span>
<span>    label_column <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>    min.segment.length <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    force_pull <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    force <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    max.overlaps <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>    box.padding <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    label.padding <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>    min_px <span class="op">=</span> <span class="fl">10</span>  <span class="co"># Only label regions with at least 10 pixels on the slice</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gg_labeled</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/region_labels-1.png" class="r-plt" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="adding-annotations">Adding annotations<a class="anchor" aria-label="anchor" href="#adding-annotations"></a>
</h2>
<div class="section level3">
<h3 id="coordinate-annotations">Coordinate annotations<a class="anchor" aria-label="anchor" href="#coordinate-annotations"></a>
</h3>
<p>Use <code><a href="../reference/annotate_coordinates.html">annotate_coordinates()</a></code> to add slice coordinate
labels to each panel:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray90"</span>, text_color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span>, overlay <span class="op">=</span> <span class="va">pe_overlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x = 0"</span>, <span class="st">"y = 0"</span>, <span class="st">"z = 30"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"underlay"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"overlay"</span>,</span>
<span>    fill_scale <span class="op">=</span> <span class="fu"><a href="../reference/scale_fill_bisided.html">scale_fill_bisided</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    remove_specks <span class="op">=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/annotate_coordinates.html">annotate_coordinates</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"black"</span>, x <span class="op">=</span> <span class="st">"right"</span>, y <span class="op">=</span> <span class="st">"bottom"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gg_coords</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/coordinate_annotations-1.png" class="r-plt" width="768"></p>
</div>
<div class="section level3">
<h3 id="orientation-annotations">Orientation annotations<a class="anchor" aria-label="anchor" href="#orientation-annotations"></a>
</h3>
<p>Use <code><a href="../reference/annotate_orientation.html">annotate_orientation()</a></code> to add neurological
orientation labels (L/R, A/P, S/I):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_orient</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray90"</span>, text_color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span>, overlay <span class="op">=</span> <span class="va">pe_overlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x = 0"</span>, <span class="st">"y = 0"</span>, <span class="st">"z = 30"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"underlay"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"overlay"</span>,</span>
<span>    fill_scale <span class="op">=</span> <span class="fu"><a href="../reference/scale_fill_bisided.html">scale_fill_bisided</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    remove_specks <span class="op">=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/annotate_orientation.html">annotate_orientation</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, color <span class="op">=</span> <span class="st">"gray20"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gg_orient</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/orientation_annotations-1.png" class="r-plt" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="creating-reusable-plot-components">Creating reusable plot components<a class="anchor" aria-label="anchor" href="#creating-reusable-plot-components"></a>
</h2>
<p>When creating multiple related plots, it’s efficient to define common
components that can be reused. This is similar to creating a ‘theme’ for
your brain plots:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define common plot elements</span></span>
<span><span class="va">common_parts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"underlay"</span>, </span>
<span>    fill_scale <span class="op">=</span> <span class="fu">scale_fill_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"grey30"</span>, high <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span>, </span>
<span>    show_legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/annotate_coordinates.html">annotate_coordinates</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"black"</span>, x <span class="op">=</span> <span class="st">"right"</span>, y <span class="op">=</span> <span class="st">"bottom"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>Now you can use <code>common_parts</code> across multiple plots with
different overlays or slice selections.</p>
</div>
<div class="section level2">
<h2 id="combining-ggbrain-plots-with-patchwork">Combining ggbrain plots with patchwork<a class="anchor" aria-label="anchor" href="#combining-ggbrain-plots-with-patchwork"></a>
</h2>
<p>The <code>patchwork</code> package provides powerful tools for
combining multiple plots. After rendering your ggbrain plots, you can
use patchwork operators to arrange them.</p>
<div class="section level3">
<h3 id="basic-patchwork-combinations">Basic patchwork combinations<a class="anchor" aria-label="anchor" href="#basic-patchwork-combinations"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create two different brain plots</span></span>
<span><span class="va">gg_axial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray90"</span>, text_color <span class="op">=</span> <span class="st">"black"</span>, title <span class="op">=</span> <span class="st">"Axial View"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span>, overlay <span class="op">=</span> <span class="va">pe_overlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"z = 20"</span>, <span class="st">"z = 40"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"underlay"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"overlay"</span>, fill_scale <span class="op">=</span> <span class="fu"><a href="../reference/scale_fill_bisided.html">scale_fill_bisided</a></span><span class="op">(</span><span class="op">)</span>, remove_specks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_sagittal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray90"</span>, text_color <span class="op">=</span> <span class="st">"black"</span>, title <span class="op">=</span> <span class="st">"Sagittal View"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span>, overlay <span class="op">=</span> <span class="va">pe_overlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x = -40"</span>, <span class="st">"x = 40"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"underlay"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"overlay"</span>, fill_scale <span class="op">=</span> <span class="fu"><a href="../reference/scale_fill_bisided.html">scale_fill_bisided</a></span><span class="op">(</span><span class="op">)</span>, remove_specks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine using patchwork</span></span>
<span><span class="va">combined</span> <span class="op">&lt;-</span> <span class="va">gg_axial</span> <span class="op">/</span> <span class="va">gg_sagittal</span> <span class="op">+</span></span>
<span>  <span class="fu">plot_annotation</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Reward Prediction Error Activation"</span>,</span>
<span>    tag_levels <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>    tag_suffix <span class="op">=</span> <span class="st">")"</span>,</span>
<span>    theme <span class="op">=</span> <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.tag <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/patchwork_basic-1.png" class="r-plt" width="960"></p>
</div>
<div class="section level3">
<h3 id="advanced-layout-with-shared-legend">Advanced layout with shared legend<a class="anchor" aria-label="anchor" href="#advanced-layout-with-shared-legend"></a>
</h3>
<p>When combining multiple plots with similar color scales, you can
extract and share a common legend:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create plots without legends</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray90"</span>, text_color <span class="op">=</span> <span class="st">"black"</span>, title <span class="op">=</span> <span class="st">"Entropy Change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span>, overlay <span class="op">=</span> <span class="va">echange_overlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x = 0"</span>, <span class="st">"z = 20"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"underlay"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"overlay"</span>, </span>
<span>             fill_scale <span class="op">=</span> <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="st">"z-stat"</span><span class="op">)</span>, </span>
<span>             remove_specks <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray90"</span>, text_color <span class="op">=</span> <span class="st">"black"</span>, title <span class="op">=</span> <span class="st">"Prediction Error"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span>, overlay <span class="op">=</span> <span class="va">abspe_overlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x = 0"</span>, <span class="st">"z = 20"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"underlay"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"overlay"</span>, </span>
<span>             fill_scale <span class="op">=</span> <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="st">"z-stat"</span><span class="op">)</span>, </span>
<span>             remove_specks <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine with collected legends and tags</span></span>
<span><span class="va">final_plot</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">plot_layout</span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">plot_annotation</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Learning-Related Brain Activation"</span>,</span>
<span>    tag_levels <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>    theme <span class="op">=</span> <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">18</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">final_plot</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/advanced_patchwork-1.png" class="r-plt" width="1152"></p>
</div>
</div>
<div class="section level2">
<h2 id="saving-ggbrain-plots-to-file">Saving ggbrain plots to file<a class="anchor" aria-label="anchor" href="#saving-ggbrain-plots-to-file"></a>
</h2>
<p>To save your plots with consistent styling, use <code>ggsave()</code>
or base R graphics devices. The <code>bg</code> argument ensures the
background color extends to the full output device:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using ggsave (recommended)</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"my_brain_plot.png"</span>, <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="va">gg_labeled</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">6</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"my_brain_plot.pdf"</span>, <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="va">gg_labeled</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using base R devices</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="st">"my_brain_plot.pdf"</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">6</span>, bg <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gg_labeled</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="st">"my_brain_plot.png"</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">6</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gg_labeled</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="filtering-images-for-focused-displays">Filtering images for focused displays<a class="anchor" aria-label="anchor" href="#filtering-images-for-focused-displays"></a>
</h2>
<p>You can filter an image to display only certain regions using the
<code>filter</code> argument in <code><a href="../reference/images.html">images()</a></code>. This is useful
when you want to focus on specific ROIs or networks:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get specific parcel values for Premotor regions</span></span>
<span><span class="va">premotor_parcels</span> <span class="op">&lt;-</span> <span class="va">dan_labels</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dan_group</span> <span class="op">==</span> <span class="st">"Premotor"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create focused display of just Premotor regions</span></span>
<span><span class="va">gg_premotor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray90"</span>, text_color <span class="op">=</span> <span class="st">"black"</span>, title <span class="op">=</span> <span class="st">"Premotor Regions"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>premotor_atlas <span class="op">=</span> <span class="va">schaefer200_atlas_2mm</span><span class="op">)</span>, </span>
<span>    labels <span class="op">=</span> <span class="va">dan_labels</span>, </span>
<span>    filter <span class="op">=</span> <span class="va">premotor_parcels</span>  <span class="co"># Only include Premotor parcels</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x = -45"</span>, <span class="st">"z = 50"</span>, <span class="st">"x = 50"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"underlay"</span>, </span>
<span>    fill_scale <span class="op">=</span> <span class="fu">scale_fill_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"grey30"</span>, high <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span>, </span>
<span>    show_legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    definition <span class="op">=</span> <span class="st">"premotor_atlas"</span>, </span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">dan_group</span><span class="op">)</span>,</span>
<span>    fill_scale <span class="op">=</span> <span class="fu">scale_fill_manual</span><span class="op">(</span><span class="st">"Region"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Premotor"</span> <span class="op">=</span> <span class="st">"#4DAF4A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    show_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    remove_specks <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/annotate_coordinates.html">annotate_coordinates</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"black"</span>, x <span class="op">=</span> <span class="st">"right"</span>, y <span class="op">=</span> <span class="st">"bottom"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gg_premotor</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/filtered_display-1.png" class="r-plt" width="768"></p>
</div>
<div class="section level2">
<h2 id="target-resolution-for-higher-quality-displays">Target resolution for higher quality displays<a class="anchor" aria-label="anchor" href="#target-resolution-for-higher-quality-displays"></a>
</h2>
<p>Use <code><a href="../reference/target_resolution.html">target_resolution()</a></code> to upsample your display for
smoother, higher-resolution figures:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Without upsampling (native 2mm resolution)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray90"</span>, text_color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span>, overlay <span class="op">=</span> <span class="va">pe_overlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"z = 30"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"underlay"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"overlay"</span>, fill_scale <span class="op">=</span> <span class="fu"><a href="../reference/scale_fill_bisided.html">scale_fill_bisided</a></span><span class="op">(</span><span class="op">)</span>, remove_specks <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Native 2mm resolution"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With upsampling to 1mm</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggbrain.html">ggbrain</a></span><span class="op">(</span>bg_color <span class="op">=</span> <span class="st">"gray90"</span>, text_color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/images.html">images</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>underlay <span class="op">=</span> <span class="va">underlay_2mm</span>, overlay <span class="op">=</span> <span class="va">pe_overlay_2mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/slices.html">slices</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"z = 30"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/target_resolution.html">target_resolution</a></span><span class="op">(</span><span class="fl">1.0</span>, interpolation <span class="op">=</span> <span class="st">"cubic"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"underlay"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_brain.html">geom_brain</a></span><span class="op">(</span>definition <span class="op">=</span> <span class="st">"overlay"</span>, fill_scale <span class="op">=</span> <span class="fu"><a href="../reference/scale_fill_bisided.html">scale_fill_bisided</a></span><span class="op">(</span><span class="op">)</span>, remove_specks <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Upsampled to 1mm with cubic interpolation"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></span></code></pre></div>
<p><img src="ggbrain_aesthetics_files/figure-html/target_resolution-1.png" class="r-plt" width="768"></p>
</div>
<div class="section level2">
<h2 id="other-considerations">Other considerations<a class="anchor" aria-label="anchor" href="#other-considerations"></a>
</h2>
<div class="section level3">
<h3 id="resampling-images-externally">Resampling images externally<a class="anchor" aria-label="anchor" href="#resampling-images-externally"></a>
</h3>
<p>Users could also consider resampling images externally using tools
like AFNI’s <code>3dresample</code> before loading into
<code>ggbrain</code>. This will yield similar results to te</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">3dresample</span> <span class="at">-input</span> functional_overlay_3mm.nii.gz <span class="dt">\</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="at">-prefix</span> functional_overlay_1mm.nii.gz <span class="dt">\</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="at">-master</span> anatomical_template_1mm.nii.gz <span class="dt">\</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="at">-rmode</span> NN</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-hierarchy-of-a-ggbrain-plot">The hierarchy of a ggbrain plot<a class="anchor" aria-label="anchor" href="#the-hierarchy-of-a-ggbrain-plot"></a>
</h3>
<p>Every ggbrain plot is composed of:</p>
<ul>
<li>
<strong>Plot</strong>: The overall container for the visualization
<ul>
<li>
<strong>Panels (Slices)</strong>: Each showing a 2D slice along one
axis (x/sagittal, y/coronal, z/axial)
<ul>
<li>
<strong>Layers</strong>: Raster data mapped to fill colors
(underlays, overlays, atlas regions)</li>
<li>
<strong>Outlines</strong>: Boundaries of clusters or regions</li>
<li>
<strong>Annotations</strong>: Text or geometric marks (coordinates,
orientation labels)</li>
<li>
<strong>Region Labels</strong>: Text labels positioned at region
centroids</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Understanding this hierarchy helps when building complex,
multi-layered visualizations.</p>
</div>
<div class="section level3">
<h3 id="tips-for-publication-quality-figures">Tips for publication-quality figures<a class="anchor" aria-label="anchor" href="#tips-for-publication-quality-figures"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Use consistent background colors</strong> across all panels
and in your output device</li>
<li>
<strong>Clean up specks and fill holes</strong> to improve visual
appearance</li>
<li>
<strong>Choose appropriate color scales</strong> - consider
colorblind-friendly palettes</li>
<li>
<strong>Add orientation and coordinate labels</strong> for
interpretability</li>
<li>
<strong>Use <code>patchwork</code> tags</strong> (A, B, C…) for
multi-panel figures</li>
<li>
<strong>Save as vector formats</strong> (PDF, SVG) for maximum
quality and editability</li>
<li>
<strong>Consider upsampling</strong> for smoother appearance in
final figures</li>
</ol>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Hallquist.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
